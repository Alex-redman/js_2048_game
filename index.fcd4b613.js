var t={};class e{constructor(t){this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}renderBoard(){let t=document.querySelectorAll(".field-cell"),e=this.board.flat();t.forEach((t,s)=>{let r=e[s];t.textContent=0===r?"":r,r>0?t.classList.add(`field-cell--${r}`):t.classList="field-cell"})}canMove(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)if(0===this.board[t][e]||e>0&&this.board[t][e]===this.board[t][e-1]||e<this.board[t].length-1&&this.board[t][e]===this.board[t][e+1]||t>0&&this.board[t][e]===this.board[t-1][e]||t<this.board.length-1&&this.board[t][e]===this.board[t+1][e])return!0;return this.lose(),!1}moveLeft(){if(!this.canMove())return;let t=this.board.map(t=>t.slice());for(let t=0;t<this.board.length;t++){let e=this.board[t].filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);let s=e.filter(t=>0!==t);for(;s.length<4;)s.push(0);if(this.board[t]=s,s.includes(2048)){this.status="win",this.displayWinMessage();return}}this.boardsAreEqual(t,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard()}moveRight(){if(!this.canMove())return;let t=this.board.map(t=>t.slice());for(let t=0;t<this.board.length;t++){let e=this.board[t].filter(t=>0!==t).reverse();for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);let s=e.filter(t=>0!==t);for(;s.length<4;)s.push(0);if(this.board[t]=s.reverse(),s.includes(2048)){this.status="win",this.displayWinMessage();return}}this.boardsAreEqual(t,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard()}moveUp(){if(!this.canMove())return;let t=this.board.map(t=>t.slice());for(let t=0;t<this.board[0].length;t++){let e=[];for(let s=0;s<this.board.length;s++)e.push(this.board[s][t]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let r=s.filter(t=>0!==t);for(;r.length<4;)r.push(0);for(let e=0;e<this.board.length;e++)this.board[e][t]=r[e];if(r.includes(2048)){this.status="win",this.displayWinMessage();return}}this.boardsAreEqual(t,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard()}moveDown(){if(!this.canMove())return;let t=this.board.map(t=>t.slice());for(let t=0;t<this.board[0].length;t++){let e=[];for(let s=0;s<this.board.length;s++)e.push(this.board[s][t]);e.reverse();let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);let r=s.filter(t=>0!==t);for(;r.length<4;)r.push(0);r.reverse();for(let e=0;e<this.board.length;e++)this.board[e][t]=r[e];if(r.includes(2048)){this.status="win",this.displayWinMessage();return}}this.boardsAreEqual(t,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard()}boardsAreEqual(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)for(let r=0;r<t[s].length;r++)if(t[s][r]!==e[s][r])return!1;return!0}getScore(){return this.score}updateScore(){document.querySelector(".game-score").textContent=this.score}getState(){return{board:this.board,score:this.score,status:this.status}}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateScore(),this.renderBoard()}resetBoard(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:r}=t[e],a=.9>Math.random()?2:4;this.board[s][r]=a,this.score+=a}}restart(){this.status="idle",this.resetBoard(),this.score=0,this.updateScore(),this.renderBoard()}lose(){this.status="lose",document.querySelector(".message-restart").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-lose").classList.remove("hidden")}displayWinMessage(){let t=document.querySelector(".message-win");document.querySelector(".message-restart").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden"),t.classList.remove("hidden")}}t=e,window.Game=e;const s=new t;document.addEventListener("keydown",t=>{switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown()}});const r=document.querySelector(".button.start"),a=document.querySelector(".message-start"),i=document.querySelector(".message-restart"),o=document.querySelector(".message-win"),d=document.querySelector(".message-lose");r.addEventListener("click",()=>{r.classList.contains("start")?(r.textContent="Restart",s.start(),r.classList.remove("start"),r.classList.add("restart"),a.classList.add("hidden"),o.classList.add("hidden"),d.classList.add("hidden"),i.classList.remove("hidden")):(r.textContent="Start",s.restart(),r.classList.remove("restart"),r.classList.add("start"),i.classList.add("hidden"),o.classList.add("hidden"),d.classList.add("hidden"),a.classList.remove("hidden"))});
//# sourceMappingURL=index.fcd4b613.js.map
